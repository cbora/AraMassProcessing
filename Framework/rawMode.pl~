#!/usr/bin/perl

sub startRawMode{

    $template =@_[0];
    $dataPath = @_[1];
    $from = @_[2];
    $to = @_[3];
    $resultPath = @_[4];
    $date = @_[5];
    $fileLimit =@_[6];

    do "fileListRawData.pl";
    do "condorSubmit.pl";
    do "loadBalanceRawData.pl";
#    do "


   # ($top, $bottom) = GetFromToFullPath($Init{'DATA_PATH'}, $Init{'FROM'}, $Init{'TO'}, $template);   #this added for raw data                                                                  
    ($top, $bottom) = GetFromToFullPath($dataPath, $from, $to, $template);
    
    
    #($pList, $pNumber) = FindFiles($Init{'DATA_PATH'}, $template, $top, $bottom);    #changed for raw data                                  
    ($pList, $pNumber) = FindFiles($dataPath, $template, $top, $bottom);

    @fileList = @{$pList};
    $totNum = ${$pNumber};
    print "Files matching template \"$template\" : $totNum\n";
    print "Files satisfying the from-to criteria: " . scalar(@fileList) . "\n";


    if (scalar(@fileList) == 0) {
        print "|-----------------------------|\n";
        print "| Nothing to do. Terminating  |\n";
        print "|-----------------------------|\n";
        close(STDOUT);
        exit 0;
    }


#    PrintFileListToFile(\@fileList, \"$Init{'RESULTS_PATH'}/$date/Input/L0filesToProcess.txt");

    $inputPath = $resultPath."/".$date."/Input/";
    $allFiles = $inputPath."L0filesToProcess.txt";
    PrintFilesListToFile(\@fileList, $allFiles);

    printCreate();
    
#    $totalFiles = SeparateTasks("$Init{'RESULTS_PATH'}/$date/Input/L0filesToProcess.txt", "$Init{'RESULTS_PATH'}/$date/Input/", $Init{'FILE_LIMIT'}); 
    $totalFiles = SeparateTasks($allFiles, $inputPath, $fileLimit);

    print "Total files = $totalFiles\n";

    printSubmit();
    
    my $clusterID;

    printShortExecution();
    
    $outputPath = $resultPath.$date;
    $clusterID = SubmitCondorJobRawData($totalFiles, $outputPath);
    


    return $clusterID;

}

      

    
